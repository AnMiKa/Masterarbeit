function [ d_gamma_upper ] = subgr_upper( W, Xval, Yval, D )
%UNTITLED10 Summary of this function goes here
%   Detailed explanation goes here

tic
[feat,T] = size(W);
[d,~,~] = size(D);
d_gamma_upper = zeros(feat,d,T);
for t = 1:T
    d_gamma_upper(:,:,t) = (Xval*bsxfun(@minus,Xval'*W(:,t),Yval))'*D(:,:,t)';
end
d_gamma_upper = sum(d_gamma_upper,3);
toc
end

